function getCurrentLanguage(){return document.querySelector("[name=post_lang_choice]").value}wp.apiFetch.use(function(t,e){return void 0===t.url&&(void 0===t.data||null===t.data?t.path+=(t.path.indexOf("?")>=0?"&lang=":"?lang=")+getCurrentLanguage():t.data.lang=getCurrentLanguage()),e(t)}),jQuery(function(t){function e(){t(".tr_lang").each(function(){var e=t(this).attr("id").substring(8),n=t(this).parent().parent().siblings(".pll-edit-column");t(this).autocomplete({minLength:0,source:ajaxurl+"?action=pll_posts_not_translated&post_language="+t(".post_lang_choice").val()+"&translation_language="+e+"&post_type="+t("#post_type").val()+"&_pll_nonce="+t("#_pll_nonce").val(),select:function(a,o){t("#htr_lang_"+e).val(o.item.id),n.html(o.item.link)}}),t(this).on("blur",function(){t(this).val()||(t("#htr_lang_"+e).val(0),n.html(n.siblings(".hidden").children().clone()))})})}t(".post_lang_choice").on("change",function(n){const a=wp.data.select,o=wp.data.dispatch,i=wp.data.subscribe,l=a("core/editor").getEditedPostAttribute("title"),c=a("core/editor").getEditedPostAttribute("content"),s=a("core/editor").getEditedPostAttribute("excerpt");var r;location.pathname.match(/post-new.php/gi)&&""===l&&""===c&&""===s&&(r=this.value,-1!=location.search.indexOf("new_lang")?window.location.search=window.location.search.replace(/(?:new_lang=[^&]*)(&)?(.*)/,"new_lang="+r+"$1$2"):window.location.search=window.location.search+(-1!=window.location.search.indexOf("?")?"&":"?")+"new_lang="+r);var d={action:"post_lang_choice",lang:n.target.value,post_type:t("#post_type").val(),post_id:t("#post_ID").val(),_pll_nonce:t("#_pll_nonce").val()};t.post(ajaxurl,d,function(n){var a=wpAjax.parseAjaxResponse(n,"ajax-response");t.each(a.responses,function(){switch(this.what){case"translations":t(".translations").html(this.data),e();break;case"flag":t(".pll-select-flag").html(this.data)}}),blockEditorSavePostAndReloadPage()}),blockEditorSavePostAndReloadPage=function(){let t=null;const e=new Promise(function(e,n){t=i(function(){const t=a("core/editor").didPostSaveRequestSucceed(),o=a("core/editor").didPostSaveRequestFail();(t||o)&&(o?n():e())})});o("core/editor").savePost(),e.then(function(){window.location.reload()},function(){t()}).catch(function(){t()})}}),e()});
