(()=>{function t(){return document.querySelector("[name=post_lang_choice]").value}wp.apiFetch.use((function(n,e){return void 0===n.url&&(void 0===n.data||null===n.data?n.path+=(n.path.indexOf("?")>=0?"&lang=":"?lang=")+t():n.data.lang=t()),e(n)})),jQuery((function(t){t(".post_lang_choice").on("change",(function(){const t=wp.data.select,n=wp.data.dispatch,e=wp.data.subscribe;let a=null;const o=new Promise((function(n,o){a=e((function(){const e=t("core/editor").didPostSaveRequestSucceed(),a=t("core/editor").didPostSaveRequestFail();(e||a)&&(a?o():n())}))}));if(location.pathname.match(/post-new.php/gi)){const n=t("core/editor").getEditedPostAttribute("title"),e=t("core/editor").getEditedPostAttribute("content"),a=t("core/editor").getEditedPostAttribute("excerpt");""===n&&""===e&&""===a&&(-1!=location.search.indexOf("new_lang")?window.location.search=window.location.search.replace(/(?:new_lang=[^&]*)(&)?(.*)/,"new_lang="+this.value+"$1$2"):window.location.search=window.location.search+(-1!=window.location.search.indexOf("?")?"&":"?")+"new_lang="+this.value)}n("core/editor").savePost(),o.then((function(){a(),window.location.reload()}),(function(){a()})).catch((function(){a()}))}))})),jQuery((function(t){function n(){t(".tr_lang").each((function(){var n=t(this).attr("id").substring(8),e=t(this).parent().parent().siblings(".pll-edit-column");t(this).autocomplete({minLength:0,source:ajaxurl+"?action=pll_posts_not_translated&post_language="+t(".post_lang_choice").val()+"&translation_language="+n+"&post_type="+t("#post_type").val()+"&_pll_nonce="+t("#_pll_nonce").val(),select:function(a,o){t("#htr_lang_"+n).val(o.item.id),e.html(o.item.link)}}),t(this).on("blur",(function(){t(this).val()||(t("#htr_lang_"+n).val(0),e.html(e.siblings(".hidden").children().clone()))}))}))}t(".post_lang_choice").on("change",(function(){var e={action:"post_lang_choice",lang:t(this).val(),post_type:t("#post_type").val(),post_id:t("#post_ID").val(),_pll_nonce:t("#_pll_nonce").val()};t.post(ajaxurl,e,(function(e){var a=wpAjax.parseAjaxResponse(e,"ajax-response");t.each(a.responses,(function(){switch(this.what){case"translations":t(".translations").html(this.data),n();break;case"flag":t(".pll-select-flag").html(this.data)}}))}))})),n()}))})();
